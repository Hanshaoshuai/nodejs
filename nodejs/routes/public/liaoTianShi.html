<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>èŠå¤©å®¤</title>
    <!-- <script src="routes/index.js" type="text/javascript" charset="utf-8"></script> -->
    <link rel="stylesheet" type="text/css" href="css/record.css" />
    <link rel="stylesheet" type="text/css" href="css/liaoTianShi.css" />
  </head>
  <body>
    <div v-show="tucaoShow" class="yijian">
      <div class="searchBox">
        <div class="home-search">
          <span class="xiangmu-left"></span>
          <span class="toNames"></span>
          <font class="xiangmu-rigth"></font>
          <ul>
            <li>æŸ¥çœ‹æ‰€æœ‰æˆå‘˜</li>
            <li>æ·»åŠ æˆå‘˜</li>
            <li class="groupOwner_log">é€€å‡ºæœ¬ç¾¤</li>
            <li class="groupOwner" style="display: none">è½¬è®©é€€å‡ºæœ¬ç¾¤</li>
            <li class="groupOwner" style="display: none">ç§»é™¤æœ¬ç¾¤</li>
          </ul>
          <!-- <div class="fanhui-right">
						<div class="tousu" @click.stop="tousuBlock()">
							<span>æŠ•è¯‰</span>
						</div>
					</div> -->
        </div>
      </div>
      <div class="content-text" id="contentTexte">
        <div class="box boxTexte" ref="boxTexte" id="box"></div>
        <div class="shuru" id="shuru">
          <ul>
            <li>
              <div class="voice"></div>
              <div class="voice_botten">
                <div class="voice_botten_text">æŒ‰ä½&nbsp;è¯´è¯</div>
              </div>
              <p
                contenteditable="true"
                placeholder="è¯·è¯¦è¾“å…¥å†…å®¹..."
                id="texts"
                class="mint-field-core"
              ></p>
              <!-- <textarea placeholder="è¯·è¯¦è¾“å…¥å†…å®¹..." id="texts" class="mint-field-core"></textarea> -->
              <div class="expressions"></div>
              <div class="fasong"><span>å‘é€</span><font></font></div>
            </li>
          </ul>
          <div class="expression">
            <div class="expressionList"></div>
          </div>
        </div>
      </div>
      <div class="tanCeng">
        <div class="tanCeng_cont">
          <div class="tanCeng_cont_top">è¯·é€‰æ‹©è½¬è®©ç¾¤ä¸»</div>
          <div class="tanCeng_cont_box">
            <div class="tanCeng_cont_box_tex">
              <!--<div class="content-food border-bottom">
								<label><div><div class="imgas">
									<p>
										<img class="border" src="'+data.body[i].headPortrait+'" alt="" />
									</p>
								</div>
									<span class="first">'+nickName+'</span>
									<input name="Fruit" type="radio" value="" id= "checkboxs"/></div></label>
							</div>-->
            </div>
          </div>
          <div class="tanCeng_cont_bottom">
            <font>ç¡®å®š</font>
            <span>å–æ¶ˆ</span>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script src="index.js" type="text/javascript" charset="utf-8"></script>
  <!-- <script
    src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.dev.js"
    type="text/javascript"
    charset="utf-8"
  ></script> -->
  <script
    src="socket.io.dev.js"
    type="text/javascript"
    charset="utf-8"
  ></script>
  <script src="jquery.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">
    var leave = document.getElementById('leaveBtn');
    var socket = io.connect('http://127.0.0.1:8080'),
      lists = {},
      textName = null,
      textName_1 = null,
      image = {},
      toId = '',
      toNameId = '',
      remarksNuberL = window.localStorage.getItem('remarksNuber');
    (textNameOld = window.localStorage.getItem('textName')),
      (Myimg = window.localStorage.getItem('myHeadPortrait')),
      (Youimg = window.localStorage.getItem('headPortrait')),
      (nickNameTop = window.localStorage.getItem('nickName')),
      (chatType = window.localStorage.getItem('type')),
      (myLocName = window.localStorage.getItem('name')),
      (locMyName = window.localStorage.getItem('myName')),
      (groupOwner = window.localStorage.getItem('groupOwner')),
      (imgId = window.localStorage.getItem('imgId')),
      (imgIdLoc = JSON.parse(window.localStorage.getItem('imgIdLoc')));

    var page = 1,
      pageSize = 10,
      dateTimes = '',
      heights = '',
      heights1 = '';
    expressionList = [
      'ğŸ˜€',
      'ğŸ˜€',
      'ğŸ˜ƒ',
      'ğŸ˜„',
      'ğŸ˜',
      'ğŸ˜†',
      'ğŸ˜…',
      'ğŸ˜‚',
      'ğŸ˜Š',
      'ğŸ˜‡',
      'ğŸ™‚',
      'ğŸ™ƒ',
      'ğŸ˜‰',
      'ğŸ˜Œ',
      'ğŸ˜',
      'ğŸ˜˜',
      'ğŸ˜—',
      'ğŸ˜™',
      'ğŸ˜š',
      'ğŸ˜‹',
      'ğŸ˜œ',
      'ğŸ˜',
      'ğŸ˜›',
      'ğŸ¤‘',
      'ğŸ¤—',
      'ğŸ¤“',
      'ğŸ˜',
      'ğŸ˜',
      'ğŸ˜’',
      'ğŸ˜',
      'ğŸ˜”',
      'ğŸ˜Ÿ',
      'ğŸ˜•',
      'ğŸ™',
      'ğŸ˜£',
      'ğŸ˜–',
      'ğŸ˜«',
      'ğŸ˜©',
      'ğŸ˜¤',
      'ğŸ˜ ',
      'ğŸ˜¡',
      'ğŸ˜¶',
      'ğŸ˜',
      'ğŸ˜‘',
      'ğŸ˜¯',
      'ğŸ˜¦',
      'ğŸ˜§',
      'ğŸ˜®',
      'ğŸ˜²',
      'ğŸ˜µ',
      'ğŸ˜³',
      'ğŸ˜±',
      'ğŸ˜¨',
      'ğŸ˜°',
      'ğŸ˜¢',
      'ğŸ˜¥',
      'ğŸ˜­',
      'ğŸ˜“',
      'ğŸ˜ª',
      'ğŸ˜´',
      'ğŸ™„',
      'ğŸ¤”',
      'ğŸ˜¬',
      'ğŸ¤',
      'ğŸ˜·',
      'ğŸ¤’',
      'ğŸ¤•',
      'ğŸ˜ˆ',
      'ğŸ‘¿',
      'ğŸ‘¹',
      'ğŸ‘º',
      'ğŸ’©',
      'ğŸ‘»',
      'ğŸ’€',
      'ğŸ‘½',
      'ğŸ‘¾',
      'ğŸ¤–',
      'ğŸƒ',
      'ğŸ˜º',
      'ğŸ˜¸',
      'ğŸ˜¹',
      'ğŸ˜»',
      'ğŸ˜¼',
      'ğŸ˜½',
      'ğŸ™€',
      'ğŸ˜¿',
      'ğŸ˜¾',
      'ğŸ‘',
      'ğŸ™Œ',
      'ğŸ‘',
      'ğŸ™',
      'ğŸ‘',
      'ğŸ‘',
      'ğŸ‘Š',
      'âœŠ',
      'ğŸ¤˜',
      'ğŸ‘Œ',
      'ğŸ‘ˆ',
      'ğŸ‘‰',
      'ğŸ‘†',
      'ğŸ‘‡',
      'âœ‹',
      'ğŸ–',
      'ğŸ––',
      'ğŸ‘‹',
      'ğŸ’ª',
      'ğŸ–•',
      'ğŸ’…',
      'ğŸ––',
      'ğŸ’„',
      'ğŸ’‹',
      'ğŸ‘„',
      'ğŸ‘…',
      'ğŸ‘‚',
      'ğŸ‘ƒ',
      'ğŸ‘',
      'ğŸ‘€',
    ];
    (function () {
      var textList = '';
      var spans = '';
      for (var i = 1; i < expressionList.length; i++) {
        spans += '<span>' + expressionList[i] + '</span>';
        if (i % 8 == 0 || i == expressionList.length - 1) {
          textList += '<div class="expression_box">' + spans + '</div>';
          spans = '';
        }
      }
      $('.expressionList').html(textList);
    })();
    if (groupOwner == myLocName) {
      $('.groupOwner').show();
      $('.groupOwner_log').hide();
    }
    if (chatType == 'chat') {
      console.log('å±è”½æ­¤äºº');
      $('.xiangmu-rigth').attr({ class: 'xiangmu-rigth rigth_background' });
      if (
        remarksNuberL == 'undefined' ||
        remarksNuberL == '' ||
        remarksNuberL == 'no'
      ) {
        $('.xiangmu-rigth').hide();
        // window.location.href = "tel:" + remarksNuberL;
      } else {
        $('.xiangmu-rigth').attr({ class: 'xiangmu-rigth dianhua' });
      }
    }
    function Default() {
      (this.props = function () {
        this.tupian();
        this.getList('types');
        this.socketIo();
        this.prent = $('.boxTexte')[0];
      }),
        (this.toChat = function (text, value) {
          if (value == myLocName) {
            return;
          }
          console.log(text, value);
          toNameId = text;
          toId = value;
        }),
        (this.tupian = function () {
          heights = $('#shuru').height();
          heights1 = $('#shuru').height();
          console.log(heights);
          if (nickNameTop != 'no' && chatType == 'chat') {
            $('.yijian .toNames').text(nickNameTop);
          } else if (chatType == 'groupChat') {
            $('.yijian .toNames').html(
              '<i class="first">' +
                nickNameTop +
                '</i><i class="last">ï¼ˆ' +
                window.localStorage.getItem('localNumber') +
                'ï¼‰</i>'
            );
          } else {
            $('.yijian .toNames').text(window.localStorage.getItem('toNames'));
          }
          $('.xiangmu-left').on('click', function () {
            window.location.href = 'liaoTianLieBiao.html';
          });
          $('.fasong font').on('click', function () {
            console.log('æ·»åŠ ');
          });
          $('.tanCeng_cont_bottom font').on('click', function () {
            if (toId == '') {
              return;
            }
            console.log('ç¡®å®š');
            for (var i = 0; i < imgIdLoc.length; i++) {
              if (imgIdLoc[i].name != myLocName) {
                textName += imgIdLoc[i].name * 1;
              }
              textName_1 += imgIdLoc[i].name * 1;
            }
            var list = {
              nickName: [locMyName],
              name: [{ name: myLocName, newsNumber: 0 }],
              imgId: [imgId],
              text:
                'ã€' +
                locMyName +
                'ã€‘å·²é€€å‡ºå°†æœ¬ç¾¤è½¬è®©ç»™' +
                'ã€' +
                toNameId +
                'ã€‘ä¸ºæœ¬ç¾¤ç¾¤ä¸»',
              buildingGroupName: nickNameTop,
              moveName: 'yes',
              Transfer: toId,
              textName: textName.toString(),
            };
            list = JSON.stringify(list);
            console.log(list, textName, textName_1, nickNameTop);
            //è½¬è®©æœ¬ç¾¤
            $.ajax({
              type: 'post',
              url: 'http://127.0.0.1:8080/buildingGroup_add',
              data: { data: list },
              success: function (data) {
                console.log(data);
                if (data.code == 200) {
                  alert(data.msg);
                  socket.emit('clientmessage', {
                    fromName: myLocName,
                    toName: [{ name: myLocName, newsNumber: 0 }],
                    text_first: 'yes',
                    text:
                      'ã€' +
                      locMyName +
                      'ã€‘å·²é€€å‡ºå°†æœ¬ç¾¤è½¬è®©ç»™' +
                      'ã€' +
                      toNameId +
                      'ã€‘ä¸ºæœ¬ç¾¤ç¾¤ä¸»',
                    nickName: nickNameTop,
                    textName: nickNameTop + textName,
                    textName_1: nickNameTop + textNameOld,
                    Transfer: toId,
                  });
                  window.location.href = 'liaoTianLieBiao.html';
                }
              },
              error: function () {
                console.log('error');
              },
            });
          });
          $('.tanCeng_cont_bottom span').on('click', function () {
            console.log('å–æ¶ˆ');
            toId = '';
            $('.tanCeng').hide();
          });
          $(document).on('click', function (e) {
            //				console.log(e)
            if (
              !$(e.target).closest('.xiangmu-rigth,.groupOwner,.tanCeng').length
            ) {
              $('.home-search ul').hide().removeAttr('class');
            }
          });
          $('.xiangmu-rigth').on('click', function () {
            if (chatType == 'chat') {
              console.log('å±è”½æ­¤äºº');
              window.location.href = 'tel:' + remarksNuberL;
              return;
            }
            if ($('.home-search ul').attr('class')) {
              $('.home-search ul').hide().removeAttr('class');
            } else {
              $('.home-search ul').show().attr({ class: 'show' });
            }
          });
          $('.home-search ul li').on('click', function () {
            if (this.innerText == 'æŸ¥çœ‹æ‰€æœ‰æˆå‘˜') {
              console.log(this.innerText);
              window.location.href = 'suoYouChengYuan.html';
              $('.box_list').hide();
              $('.box_friend').show();
              $('.home-search ul').hide().removeAttr('class');
            } else if (this.innerText == 'æ·»åŠ æˆå‘˜') {
              console.log(this.innerText);
              $('.box_friend').hide();
              $('.box_list').show();
              $('.home-search ul').hide().removeAttr('class');
              window.location.href = 'tianJiaChengYuan.html';
            } else if (this.innerText == 'é€€å‡ºæœ¬ç¾¤') {
              console.log(this.innerText);
              $('.box_friend').hide();
              $('.box_list').show();
              $('.home-search ul').hide().removeAttr('class');
              for (var i = 0; i < imgIdLoc.length; i++) {
                if (imgIdLoc[i].name != myLocName) {
                  textName += imgIdLoc[i].name * 1;
                }
                textName_1 += imgIdLoc[i].name * 1;
              }
              var list = {
                nickName: [locMyName],
                name: [{ name: myLocName, newsNumber: 0 }],
                imgId: [imgId],
                text: 'ã€' + locMyName + 'ã€‘å·²é€€å‡ºæœ¬ç¾¤',
                buildingGroupName: nickNameTop,
                moveName: 'yes',
                textName: textName.toString(),
              };
              list = JSON.stringify(list);
              console.log(
                list,
                nickNameTop + textName,
                nickNameTop + textName_1
              );
              //é€€å‡ºæœ¬ç¾¤
              $.ajax({
                type: 'post',
                url: 'http://127.0.0.1:8080/buildingGroup_add',
                data: { data: list },
                success: function (data) {
                  console.log(data);
                  if (data.code == 200) {
                    alert(data.msg);
                    socket.emit('clientmessage', {
                      fromName: myLocName,
                      toName: [{ name: myLocName, newsNumber: 0 }],
                      text_first: 'yes',
                      text: 'ã€' + locMyName + 'ã€‘å·²é€€å‡ºæœ¬ç¾¤',
                      nickName: nickNameTop,
                      textName: nickNameTop + textName,
                      textName_1: nickNameTop + textNameOld,
                    });
                    window.location.href = 'liaoTianLieBiao.html';
                  }
                },
                error: function () {
                  console.log('error');
                },
              });
            } else if (this.innerText == 'è½¬è®©é€€å‡ºæœ¬ç¾¤') {
              console.log(this.innerText);
              $('.tanCeng').show();
              var monList = '',
                name_list = '',
                iconName_list = '';
              //						$('.box_friend').hide();
              //						$('.box_list').show();
              //						$('.home-search ul').hide().removeAttr('class');
              //						window.location.href = 'èŠå¤©åˆ—è¡¨.html';
              for (var i = 0; i < imgIdLoc.length; i++) {
                var disabled = null;
                if (imgIdLoc[i].name == myLocName) {
                  disabled = 'disabled="disabled"';
                }
                name_list = "'" + imgIdLoc[i].nickName + "'";
                iconName_list = "'" + imgIdLoc[i].name + "'";
                monList +=
                  '<div class="content-food border-bottom" onClick="that.toChat(' +
                  name_list +
                  ',' +
                  iconName_list +
                  ')">' +
                  '<label><div><div class="imgas">' +
                  '<p>' +
                  '<img class="border" src="' +
                  imgIdLoc[i].classIcon +
                  '" alt="" />' +
                  '</p>' +
                  '</div>' +
                  '<span class="first">' +
                  imgIdLoc[i].nickName +
                  '</span>' +
                  '<input ' +
                  disabled +
                  ' name="Fruit" type="radio" value="' +
                  imgIdLoc[i].name +
                  '" id= "checkboxs"/></div></label>' +
                  '</div>';
              }
              $('.tanCeng_cont_box_tex').html(monList);
            } else if (this.innerText == 'ç§»é™¤æœ¬ç¾¤') {
              console.log(this.innerText);
              //ç§»é™¤æœ¬ç¾¤;
              $.ajax({
                type: 'post',
                url: 'http://127.0.0.1:8080/buildingGroup_move',
                data: { nickName: nickNameTop },
                success: function (data) {
                  console.log(data);
                  if (data.code == 200) {
                    alert(data.msg);
                    // objs_name.splice(objs_name.length-1,1);
                    socket.emit('clientmessage', {
                      fromName: myLocName,
                      toName: [],
                      text_last: 'yes',
                      text: nickNameTop + 'å·²å°†æœ¬ç¾¤ç§»é™¤...',
                      type: 'groupChat',
                    });
                    $('.box_friend').hide();
                    $('.box_list').show();
                    $('.home-search ul').hide().removeAttr('class');
                    window.location.href = 'liaoTianLieBiao.html';
                  }
                },
                error: function () {
                  console.log('error');
                },
              });
            }
          });

          $('#texts').bind('input propertychange click', function () {
            // console.log('kkkkkkk',$("#texts")[0].innerText);
            if ($('#texts')[0].innerText == '') {
              $('.fasong').css({ background: 'none' }).find('span').hide();
              $('.fasong font').show();
            } else {
              $('.fasong font').hide();
              $('.fasong').css({ background: '#ff7a59' }).find('span').show();
            }
            if ($('.expression').attr('show')) {
              console.log('kkkkkkk', $('#texts').val);
              $('.expressions').attr({ class: 'expressions' });
              $('.expression').hide().removeAttr('show');
            }
            var height = $('#shuru').height();
            // console.log('kkkkkkk'+height);
            if (height > heights + 6) {
              heights = height;
              $('#box').css({ 'padding-bottom': height + 12 + 'px' });
              $('#shuru ul').css({ 'padding-top': '0' });
            } else {
              if (height < heights1) {
                $('#shuru ul').css({ 'padding-top': '0.14rem' });
                heights1 = $('#shuru').height();
                heights = $('#shuru').height();
              }
              $('#box').css({ 'padding-bottom': height + 12 + 'px' });
            }
            that.scrollHeights();
          });
          //ç‚¹å‡»è¯­éŸ³
          $('.voice').on('click', function () {
            if ($('.voice').attr('show')) {
              $('.voice').attr({ class: 'voice' }).removeAttr('show');
              $('.voice_botten').hide();
              $('.mint-field-core').show();
            } else {
              $('.voice').attr({ class: 'voice voice_image', show: 'show' });
              $('.voice_botten').show();
              $('.mint-field-core').hide();
              $('.expressions').attr({ class: 'expressions' });
              $('.expression').hide().removeAttr('show');
              $('#box').css({
                'padding-bottom': $('#shuru').height() + 12 + 'px',
              });
            }
          });
          //ç‚¹å‡»è¡¨æƒ…åŒ…
          $('.expressions').on('click', function () {
            $('#texts').focus();
            // $( '#texts' ).blur();å¤±å»ç„¦ç‚¹
            if ($('.expression').attr('show')) {
              console.log('kkkkkkk');
              $('.expressions').attr({ class: 'expressions' });
              $('.expression').hide().removeAttr('show');
              $('#box').css({
                'padding-bottom': $('#shuru').height() + 12 + 'px',
              });
              $('.voice_botten').hide();
              $('.mint-field-core').show();
            } else {
              $('.expression').show().attr({ show: 'show' });
              $('.expressions').attr({ class: 'expressions expres_image' });
              $('#box').css({
                'padding-bottom': $('#shuru').height() + 12 + 'px',
              });
              $('.voice_botten').hide();
              $('.mint-field-core').show();
              $('.voice').attr({ class: 'voice' }).removeAttr('show');
              // $('.voice').attr({"class":'voice voice_image',"show":'show'});
              that.scrollHeights();
            }
          });
          //ç‚¹å‡»æŸä¸ªè¡¨æƒ…ç»™è¾“å…¥èµ‹å€¼
          $('.expressionList span').on('click', function () {
            console.log(this.innerHTML);
            // $('#texts')[0].innerText += this.innerText;
            // $( '#texts' ).focus();
            $('.fasong font').hide();
            $('.fasong').css({ background: '#ff7a59' }).find('span').show();
            that.toEnd(this.innerHTML);
            that.scrollHeights();
          });
        }),
        (this.toEnd = function (text) {
          var obj = document.getElementById('texts');
          var range, node;
          if (!obj.hasfocus) {
            obj.focus();
          }
          if (window.getSelection && window.getSelection().getRangeAt) {
            range = window.getSelection().getRangeAt(0);
            range.collapse(false);
            node = range.createContextualFragment(text);
            var c = node.lastChild;
            range.insertNode(node);
            if (c) {
              range.setEndAfter(c);
              range.setStartAfter(c);
            }
            var j = window.getSelection();
            j.removeAllRanges();
            j.addRange(range);
          } else if (document.selection && document.selection.createRange) {
            document.selection.createRange().pasteHTML(text);
          }
          $('#box').css({ 'padding-bottom': $('#shuru').height() + 12 + 'px' });
        });
      //è¿‡å»å¼è®°å½•æ ¼å¼ä¸ºï¼šå‡ æ—¶å‡ åˆ†ã€è¶…è¿‡24å°æ—¶æ˜¾ç¤ºå‡ æœˆå‡ æ—¥
      (this.numToTime = function (num) {
        if (num == '') {
          return;
        }
        var newNum = new Date().getTime(),
          time = new Date(num).toLocaleString(),
          date = new Date(new Date()),
          year,
          mouth,
          day,
          h,
          m,
          newTime = new Date(newNum).toLocaleString(),
          week = {
            0: 'æ—¥',
            6: 'ä¸€',
            5: 'äºŒ',
            4: 'ä¸‰',
            3: 'å››',
            2: 'äº”',
            1: 'å…­',
          },
          getDays = new Date().getDate() * 1;
        //        console.log(newNum)
        time = time.replace(/\d+[\/\-]/, function (text) {
          year = text.match(/\d+/)[0];
          return '';
        });
        time = time.replace(/\d+[\/\-]/, function (text) {
          mouth = text.match(/\d+/)[0];
          return '';
        });
        time = time.replace(/\d+/, function (text) {
          day = text.match(/\d+/)[0];
          return '';
        });
        time = time.replace(/\d+/, function (text) {
          h = text.match(/\d+/)[0];
          return '';
        });
        time = time.replace(/\d+/, function (text) {
          m = text.match(/\d+/)[0];
          return '';
        });
        num = (newNum - num) / 1000;
        function getHours() {
          if (/ä¸Šåˆ/.test(time)) {
            if (h == 12 || h < 5) {
              if (h == 12) {
                return 'å‡Œæ™¨00' + ':' + m;
              } else {
                return 'å‡Œæ™¨0' + h.toString() + ':' + m;
              }
            } else if (h == 5) {
              return 'æ¸…æ™¨0' + h.toString() + ':' + m;
            } else if (h > 5 && h < 11) {
              if (h == 10) {
                return 'æ—©ä¸Š' + h.toString() + ':' + m;
              } else {
                return 'æ—©ä¸Š0' + h.toString() + ':' + m;
              }
            } else if (h > 10 && h < 12) {
              return 'ä¸­åˆ' + h.toString() + ':' + m;
            }
          } else {
            if (h == 12 || h < 1) {
              if (h == 12) {
                return 'ä¸­åˆ' + h.toString() + ':' + m;
              } else {
                return 'ä¸­åˆ' + (h * 1 + 12).toString() + ':' + m;
              }
            } else if (h > 0 && h < 7) {
              return 'ä¸‹åˆ' + (h * 1 + 12).toString() + ':' + m;
            } else if (h > 6 && h < 12) {
              return 'æ™šä¸Š' + (h * 1 + 12).toString() + ':' + m;
            }
          }
        }
        //        console.log('ooooooo====',date.getDay());
        if (getDays == day * 1) {
          return getHours();
        }
        if (getDays - day * 1 == 1) {
          return 'æ˜¨å¤©&nbsp' + getHours();
        } else if (getDays - day * 1 > 1 && getDays - day * 1 < day * 1) {
          // return 'å‘¨' + week[getDays - day*1 + ""] + '&nbsp' + getHours();
        }
        if (year === newTime.match(/\d+/)[0]) {
          return mouth + 'æœˆ' + day + 'æ—¥&nbsp' + getHours();
        } else {
          return year + 'å¹´' + mouth + 'æœˆ' + day + 'æ—¥&nbsp' + getHours();
        }
      }),
        (this.tousuoGo = function (times, text) {
          //æç¤ºæŠ•è¯‰ä¿¡æ¯å†…å®¹æŒ‰é’®
          if (text == 'no') {
            return;
          }
          this.tousuoContent = 'æŠ•è¯‰æˆåŠŸï¼';
          var tiShi = document.createElement('div'); //æç¤ºä¿¡æ¯å†…å®¹
          var textCont = document.createElement('font');
          textCont.innerHTML = times; //åå°è·å–ä¿¡æ¯æ’å…¥
          tiShi.appendChild(textCont);
          this.prent.appendChild(tiShi);
          textCont.style.color = '#fff';
          textCont.style.lineHeight = '0.44rem';
          textCont.style.fontSize = '0.32rem';
          textCont.style.background = '#cfced2';
          textCont.style.display = 'inline-block';
          textCont.style.padding = '0 0.12rem';
          textCont.style.borderRadius = '0.08rem';
          textCont.style.wordWrap = 'break-word';
          tiShi.style.fontSize = 0;
          tiShi.style.width = '82%';
          tiShi.style.margin = '0 auto';
          tiShi.style.padding = '0.2rem 0';
          tiShi.style.textAlign = 'center';
        }),
        (this.ChushiHuaTimes = function () {
          //åˆå§‹åŒ–æ—¶é—´å‡½æ•°
          var times = new Date(); //å®ä¾‹åŒ–æ—¥æœŸå¯¹è±¡ï¼›
          var myMonth = times.getMonth(); //å½“å‰çš„æœˆä»½ï¼›
          myMonth = myMonth + 1; //å½“å‰çš„æœˆä»½ï¼›
          var myDate = times.getDate(); //å½“å‰çš„æ—¥æœŸï¼›
          var myHours = times.getHours(); //å½“å‰çš„å°æ—¶ï¼›
          var newNum = times.getTime(),
            time = new Date(newNum).toLocaleString();
          if (/ä¸Šåˆ/.test(time)) {
            if (myHours == 12 || myHours < 5) {
              if (myHours == 12) {
                myHours = 'å‡Œæ™¨00';
              } else {
                myHours = 'å‡Œæ™¨0' + myHours.toString();
              }
            } else if (myHours == 5) {
              myHours = 'æ¸…æ™¨0' + myHours.toString();
            } else if (myHours > 5 && myHours < 11) {
              if (myHours == 10) {
                myHours = 'æ—©ä¸Š' + myHours.toString();
              } else {
                myHours = 'æ—©ä¸Š0' + myHours.toString();
              }
            } else if (myHours > 10 && myHours < 12) {
              myHours = 'ä¸­åˆ' + myHours.toString();
            }
          } else {
            console.log(myHours);
            if (myHours == 12 || myHours < 13) {
              if (myHours == 12) {
                myHours = 'ä¸­åˆ' + myHours.toString();
              } else {
                myHours = 'ä¸­åˆ' + myHours.toString();
              }
            } else if (myHours > 12 && myHours < 19) {
              myHours = 'ä¸‹åˆ' + myHours.toString();
            } else if (myHours > 18 || myHours == 0) {
              myHours = 'æ™šä¸Š' + myHours.toString();
            }
          }
          if (times.getMinutes() < 10) {
            var myMinutes = '0' + times.getMinutes().toString(); //å½“å‰çš„åˆ†é’Ÿï¼›
          } else {
            var myMinutes = times.getMinutes(); //å½“å‰çš„åˆ†é’Ÿï¼›
          }
          // console.log(times)
          return myHours + ':' + myMinutes;
        }),
        (this.FasongShijian = function () {
          //å‘é€æ—¶é—´æ˜¾ç¤ºå‡½æ•°
          var timeHour = new Date().getTime();
          if (timeHour - dateTimes < 100000) {
            console.log(timeHour - dateTimes);
            dateTimes = timeHour;
            return;
          }
          dateTimes = timeHour;
          // var contentTexte=this.$refs.contentTexte;
          var shiJian = document.createElement('div');
          var shiJianCont = document.createElement('p');
          shiJianCont.innerHTML = this.ChushiHuaTimes(); //è°ƒç”¨åˆå§‹åŒ–æ—¶é—´å‡½æ•°
          shiJian.appendChild(shiJianCont);
          this.prent.appendChild(shiJian);
          shiJian.style.fontSize = 0;
          shiJianCont.style.color = '#fff';
          shiJianCont.style.fontSize = '0.32rem';
          shiJianCont.style.background = '#cfced2';
          shiJianCont.style.display = 'inline-block';
          shiJianCont.style.padding = '0 0.12rem';
          shiJianCont.style.borderRadius = '0.08rem';
          shiJian.style.padding = '0.2rem 0';
          shiJian.style.textAlign = 'center';
          // contentTexte.scrollTop=contentTexte.scrollHeight;  //æ»šåŠ¨æ¡å§‹ç»ˆåœ¨ä¸‹é¢
        }),
        (this.TishiNeirong = function (texts) {
          //æˆ–å…¶ä»–å…¬å‘Šæç¤ºä¿¡æ¯
          var tiShi = document.createElement('div'); //åˆ›å»ºDOMå…ƒç´ 
          var textCont = document.createElement('font');
          textCont.innerText = texts; //æ’å…¥æç¤ºä¿¡æ¯
          tiShi.appendChild(textCont);
          this.prent.appendChild(tiShi);
          textCont.style.color = '#b4b4b4';
          textCont.style.lineHeight = '0.4rem';
          textCont.style.fontSize = '0.32rem';
          textCont.style.wordWrap = 'break-word';
          tiShi.style.width = '82%';
          tiShi.style.fontSize = '0';
          tiShi.style.margin = '0 auto';
          tiShi.style.padding = '0.2rem 0';
          tiShi.style.textAlign = 'center';
        }),
        (this.scrollHeights = function () {
          var dom1 = document.getElementById('contentTexte');
          var el_height = dom1.scrollHeight; //   ===>  è·å¾—æ»šåŠ¨æ¡çš„é«˜åº¦
          $('#contentTexte').scrollTop(el_height); //  ===> è®¾ç½®æ»šåŠ¨æ¡çš„ä½ç½®ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨
        }),
        (this.clearNumber = function (
          fromName,
          toName,
          groupChat,
          nickNameTop
        ) {
          console.log(fromName, toName, groupChat, nickNameTop);
          var toName_1 = null;
          if (groupChat) {
            toName_1 = JSON.stringify(toName);
          } else {
            toName_1 = toName;
          }

          // æ¶ˆæ¯æ¸…é›¶
          $.ajax({
            type: 'post',
            url: 'http://127.0.0.1:8080/post6',
            data: {
              fromName: fromName,
              myName: toName_1,
              clear: 'ok',
              type: groupChat,
              nickName: nickNameTop,
            },
            success: function (data) {
              console.log(data);
              if (data.code == 200) {
                // alert(data.msg);
                // getList1('location');
                // window.localStorage.setItem('toChatName',friendName);
              }
            },
            error: function () {
              console.log('error');
            },
          });
        }),
        (this.socketIo = function () {
          //æ¶ˆæ¯ç›‘å¬
          socket.on('message', function (data) {
            if (data.text) {
              if (data.text.fromName == myLocName) {
                console.log('000-', data.text);

                if (data.text.text_last) {
                  return;
                }
                that.FasongShijian();
                if (data.text.text.friends == 'yes') {
                  that.TishiNeirong(
                    'ä½ é€šè¿‡äº†å¯¹æ–¹çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼Œç°åœ¨å¯ä»¥å¼€å§‹èŠå¤©å•¦ğŸ˜„'
                  );
                  //								that.TishiNeirong(data.text.text.text);
                } else if (data.text.text.friend == 'no') {
                  that.TishiNeirong('æ‚¨å‘å¯¹æ–¹å‘é€äº†å¥½å‹éªŒè¯è¯·æ±‚ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼');
                } else if (data.text.text.friends == 'no') {
                  that.TishiNeirong('æ‚¨æ‹’ç»äº†å¯¹æ–¹çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼');
                } else {
                  that.My('', data.text.text);
                }
                // that.My('',data.text.text);
                $('#texts')[0].innerText = '';
                $('.fasong').css({ background: 'none' }).find('span').hide();
                $('.fasong font').show();
              } else if (
                data.text.fromName === myLocName &&
                data.text.toName != '' &&
                data.text.toName != myLocName
              ) {
                console.log('111-', data.text);
                that.My('', data.text.text);
              } else if (
                data.text.toName === myLocName &&
                data.text.fromName == window.localStorage.getItem('toChatName')
              ) {
                console.log('222-', data.text);
                that.FasongShijian();
                var settime = setTimeout(function () {
                  that.clearNumber(data.text.fromName, data.text.toName);
                  clearTimeout(settime);
                }, 200);
                if (data.text.text.friends == 'yes') {
                  $('.shuru').show();
                  that.TishiNeirong(data.text.text.text);
                } else if (data.text.text.friend == 'no') {
                  that.You(
                    'yes',
                    '',
                    'ğŸ˜„æ¥è‡ª' + data.text.fromName + 'çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼Œæ˜¯å¦åŒæ„ï¼'
                  );
                  $('.shuru').hide();
                  // that.TishiNeirong(data.text.text);
                } else {
                  if (data.text.text.friends == 'no') {
                    that.You(
                      'yes',
                      'no',
                      'ğŸ™å¯¹æ–¹æ‹’ç»äº†æ‚¨çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼æ˜¯å¦å†æ¬¡æ·»åŠ å¥½å‹...',
                      'no'
                    );
                  } else {
                    that.You('yes', 'yes', data.text.text);
                  }
                }
              } else if (data.text.type == 'groupChat') {
                //ç¾¤èŠæ•°æ®
                console.log('333-', data);
                if (data.text.text_last) {
                  alert('æœ¬ç¾¤å·²è¢«ç§»é™¤ï¼');
                  window.location.href = 'liaoTianLieBiao.html';
                  return;
                }
                that.FasongShijian();
                if (data.text.text_first) {
                  that.TishiNeirong(data.text.text);
                } else {
                  //								that.You('yes','yes',data.text.text,data.text.fromName,data.text.text_first);
                  that.You(
                    'yes',
                    'yes',
                    data.text.text,
                    data.text.fromName,
                    data.text.myIconName
                  );
                  var settime = setTimeout(function () {
                    that.clearNumber(
                      myLocName,
                      window.localStorage.getItem('toChatName'),
                      'groupChat',
                      nickNameTop
                    );
                    clearTimeout(settime);
                  }, 200);
                }
              }
              if (data.text.toName === '' && data.text.fromName !== myLocName) {
                console.log('444-', data.text);
                // toDom(data.text.fromName,data.text.text,data.text.dateTime);
              }
              that.scrollHeights();
            }
          });
          //å¡«å……å¯¹æ–¹çš„å¯¹è¯æ¡†
          function toDom(fromName, text, dateTime) {
            // 					var dom = $('#list_test');
            // 					dom.append("<li style='height:36px;text-align:center;width:100%;color:red;'>æ—¶é—´"+dateTime+"</li>");
            // 					dom.append("<li style='height:36px;'>"+fromName+"åœ¨å…¬å‘Šï¼š"+text+"</li>");
            // 					var el_height = dom[0].scrollHeight//   ===>  è·å¾—æ»šåŠ¨æ¡çš„é«˜åº¦
            // 					dom.scrollTop(el_height)//  ===> è®¾ç½®æ»šåŠ¨æ¡çš„ä½ç½®ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨
          }
          //å‘é€æ¶ˆæ¯
          $('.fasong span').click(function () {
            var timeHour = new Date().getTime();
            var dateYes = 'no';
            if (timeHour - dateTimes > 100000) {
              console.log(timeHour - dateTimes);
              dateYes = 'yes';
            }
            $('.expressions').attr({ class: 'expressions' });
            $('.expression').hide().removeAttr('show');
            $('#shuru ul').css({ 'padding-top': '0.14rem' });
            $('#box').css({ 'padding-bottom': '1.2rem' });
            heights1 = $('#shuru').height();
            heights = $('#shuru').height();
            function Trim(str) {
              return str.replace(/(^\s*)|(\s*$)/g, '');
            }
            // console.log(Trim($('#texts')[0].innerText))
            $('.expression').hide();
            if (Trim($('#texts')[0].innerText) != '') {
              if (chatType == 'chat') {
                socket.emit('clientmessage', {
                  fromName: myLocName,
                  // toName: $('#texts0')[0].value,
                  toName: window.localStorage.getItem('toChatName'),
                  text: Trim($('#texts')[0].innerText),
                  fromTo: (
                    window.localStorage.getItem('toChatName') * 1 +
                    myLocName * 1
                  ).toString(),
                  dateTimes: dateYes,
                });
              } else {
                //ç¾¤èŠ
                var toChatNames = window.localStorage
                    .getItem('toChatName')
                    .split(','),
                  fromChat = null;
                for (var i = 0; i < toChatNames.length; i++) {
                  fromChat += toChatNames[i].name * 1;
                }
                fromChat = nickNameTop + fromChat.toString();
                socket.emit('clientmessage', {
                  fromName: myLocName,
                  // toName: $('#texts0')[0].value,
                  toName: JSON.parse(window.localStorage.getItem('toChatName')),
                  text: Trim($('#texts')[0].innerText),
                  fromTo: fromChat,
                  nickName: nickNameTop,
                  dateTimes: dateYes,
                  myIconName: locMyName,
                });
              }
            }
          });
        }),
        (this.getList = function getList(types) {
          $.ajax({
            type: 'get',
            url: 'http://127.0.0.1:8080/get1',
            data: {
              type: chatType,
              page: page,
              pageSize: pageSize,
              friendName: window.localStorage.getItem('toChatName'),
              myName: myLocName,
              nickName: nickNameTop,
            },
            success: function (data) {
              console.log(data);
              if ((data.code = 200)) {
                var dom0 = $('#list_test');
                var dom1 = $('.content-text');
                var dom;
                var length = data.body.length,
                  yes = '';
                if ($('#list_test').find('li').eq(0).length !== 0) {
                  dom = dom0.find('li').eq(0);
                } else {
                  dom = dom0.find('p');
                }
                console.log(dom);
                dateTimes = data.body[length - 1].dateTime;
                for (var i = 0; i < length; i++) {
                  if (!data.body[length - 1].friend) {
                    yes = 'yes';
                  }
                  // console.log('000',data.body[i]);
                  if (data.body[i].fromName == myLocName) {
                    // console.log('111',data.body[i]);
                    if (data.body[i].type == 'chat') {
                      that.tousuoGo(
                        that.numToTime(data.body[i].dateTime),
                        data.body[i].dateTimes
                      );
                      if (data.body[i].text.friends == 'yes') {
                        $('.shuru').show();
                        that.TishiNeirong(
                          'ä½ å·²é€šè¿‡å¯¹æ–¹çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼Œç°åœ¨å¯ä»¥å¼€å§‹èŠå¤©å•¦ğŸ˜„'
                        );
                        //											that.TishiNeirong(data.body[i].text.text);
                      } else if (data.body[i].text.friend == 'no') {
                        $('.shuru').hide();
                        that.TishiNeirong(
                          'æ‚¨å‘å¯¹æ–¹å‘é€äº†å¥½å‹éªŒè¯è¯·æ±‚ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼'
                        );
                      } else if (data.body[i].text.friends == 'no') {
                        $('.shuru').hide();
                        that.TishiNeirong('æ‚¨æ‹’ç»äº†å¯¹æ–¹çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼');
                      } else {
                        that.My('', data.body[i].text);
                      }
                    } else if (chatType == 'groupChat') {
                      that.tousuoGo(
                        that.numToTime(data.body[i].dateTime),
                        data.body[i].dateTimes
                      );
                      if (data.body[i].text_first) {
                        that.TishiNeirong(data.body[i].text);
                      } else {
                        that.My('', data.body[i].text);
                      }
                    }
                  } else if (
                    data.body[i].fromName === myLocName &&
                    data.body[i].toName !== '' &&
                    data.text.toName != myLocName
                  ) {
                    // console.log('222',data.body[i]);
                    that.My('', data.body[i].text);
                  } else if (
                    data.body[i].toName === '' &&
                    data.body[i].fromName === myLocName
                  ) {
                  } else if (
                    data.body[i].toName === '' &&
                    data.body[i].fromName !== myLocName
                  ) {
                    //
                  } else if (data.body[i].toName === myLocName) {
                    // console.log('333',data.body[i]);
                    that.tousuoGo(
                      that.numToTime(data.body[i].dateTime),
                      data.body[i].dateTimes
                    );
                    if (data.body[i].text.friend == 'no') {
                      if (data.body[i].friend == 'yes') {
                        that.You(
                          yes,
                          '',
                          'ğŸ˜„æ¥è‡ª' +
                            data.body[i].fromName +
                            'çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼Œæ˜¯å¦åŒæ„ï¼',
                          1
                        );
                      } else {
                        that.You(
                          yes,
                          '',
                          'ğŸ˜„æ¥è‡ª' +
                            data.body[i].fromName +
                            'çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼Œæ˜¯å¦åŒæ„ï¼'
                        );
                        $('.shuru').hide();
                      }
                    } else {
                      if (data.body[i].text.friends == 'yes') {
                        $('.shuru').show();
                        that.You(yes, 'yes', data.body[i].text.text);
                        //											that.TishiNeirong(data.body[i].text.text);
                      } else if (data.body[i].text.friends == 'no') {
                        $('.shuru').hide();
                        // that.TishiNeirong('å¯¹æ–¹æ‹’ç»äº†æ‚¨çš„å¥½å‹è¯·æ±‚ï¼');
                        that.You(
                          yes,
                          'no',
                          'ğŸ™å¯¹æ–¹æ‹’ç»äº†æ‚¨çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼æ˜¯å¦å†æ¬¡æ·»åŠ å¥½å‹...',
                          data.body[i].friend
                        );
                      } else {
                        that.You(yes, 'yes', data.body[i].text);
                      }
                    }
                  } else if (data.body[i].type == 'groupChat') {
                    that.tousuoGo(
                      that.numToTime(data.body[i].dateTime),
                      data.body[i].dateTimes
                    );
                    if (data.body[i].text_first) {
                      that.TishiNeirong(data.body[i].text);
                    } else {
                      that.You(
                        yes,
                        'yes',
                        data.body[i].text,
                        data.body[i].fromName,
                        data.body[i].myIconName
                      );
                    }
                  }
                }
                if (types) {
                  dom1.scrollTop(0);
                } else {
                  // 							var el_height = dom0[0].scrollHeight//   ===>  è·å¾—æ»šåŠ¨æ¡çš„é«˜åº¦
                  // 							dom0.scrollTop(el_height)//  ===> è®¾ç½®æ»šåŠ¨æ¡çš„ä½ç½®ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨
                }
              }
              page += 1;
            },
            error: function () {
              console.log('error');
            },
          });
        }),
        (this.My = function (type, cont) {
          //æˆ‘è¦å‘é€ä¿¡æ¯å¤„ç†å‡½æ•°
          // var contentTexte=this.$refs.contentTexte;
          var you = document.createElement('div'); //åˆ›å»ºå…ƒç´         æˆ‘è¦å‘é€çš„dom
          var neiRong = document.createElement('div'); //å†…å®¹ä¿¡æ¯
          var touXiang = document.createElement('div'); //å¤´åƒ
          var span = document.createElement('span');
          var imaF = document.createElement('div');
          var img = document.createElement('img');
          var imgs = document.createElement('div');
          you.setAttribute('class', 'fankiu-you'); //æ·»åŠ å±æ€§
          neiRong.setAttribute('class', 'fankiu-text clearbox');
          touXiang.setAttribute('class', 'fankiu-img');
          imgs.style.backgroundImage = 'url(' + '"' + this.Youimg + '"' + ')';
          imgs.style.backgroundSize = '100% 100%';
          //				img.setAttribute("class","border");
          //					span.appendChild(imgs);float: left;
          neiRong.appendChild(span);
          neiRong.appendChild(imgs);
          imaF.appendChild(img);
          touXiang.appendChild(imaF);
          you.appendChild(neiRong);
          you.appendChild(touXiang);
          this.prent.appendChild(you);
          you.style.width = '92%'; //æ ·å¼4
          you.style.margin = '0 auto';
          you.style.textAlign = 'justify';
          you.style.lineHeight = '0.4rem';
          you.style.overflow = 'hidden';
          you.style.padding = '0.1rem 0';
          neiRong.style.width = '86%';
          neiRong.style.float = 'left';
          //					neiRong.style.overflow="hidden";
          neiRong.style.position = 'relative';
          span.style.display = 'inline-block';
          span.style.padding = '0.16rem 0.2rem';
          span.style.background = '#ff7a59';
          span.style.color = '#fff';
          span.style.float = 'right';
          span.style.maxWidth = '77%';
          span.style.borderRadius = '0.08rem';
          span.style.fontSize = '0.32rem';
          span.style.border = '0.01rem solid #e7e6e9';
          span.style.wordWrap = 'break-word';
          touXiang.style.width = '14%';
          touXiang.style.float = 'left';
          touXiang.style.overflow = 'hidden';
          imaF.style.width = '0.76rem';
          imaF.style.height = '0.76rem';
          imaF.style.border = '0.01rem solid #e7e6e9';
          imaF.style.boxSizing = 'border-box';
          imaF.style.float = 'right';
          imaF.style.overflow = 'hidden';
          imaF.style.borderRadius = '0.04rem';
          img.style.background = '#EAEAEA';
          img.style.float = 'right';
          img.style.borderRadius = '0.04rem';
          img.src = Myimg;
          img.style.width = '100%';
          imgs.style.position = 'absolute';
          imgs.style.width = '0.16rem';
          imgs.style.height = '0.22rem';
          imgs.style.top = '0.26rem';
          imgs.style.right = '-0.13rem';
          // 				if(type==1){			//å‘é€çš„æ˜¯åç‰‡
          // 					span.style.background="#fff";
          // //					imgs.style.background="#fff";
          // 					span.appendChild(this.MingpianTishi(cont));
          // 				}else{
          span.innerHTML = cont; //å¯¹åº”æ’å…¥
          // this.introduction="";
          // }
          // this.FasongShijian();
          // contentTexte.scrollTop=contentTexte.scrollHeight;  //æ»šåŠ¨æ¡å§‹ç»ˆåœ¨ä¸‹é¢
        }),
        (this.You = function (
          yes,
          type,
          cont,
          DianJi,
          myIconName,
          remarksNuber
        ) {
          //å¯¹æ–¹è¦å‘é€ä¿¡æ¯å¤„ç†å‡½æ•°
          // var contentTexte=this.$refs.contentTexte;
          var my = document.createElement('div'); //åˆ›å»ºå…ƒç´ 		å¯¹æ–¹è¦å‘é€çš„dom
          var neiRong = document.createElement('div');
          var touXiang = document.createElement('div');
          var span = document.createElement('span');
          var imaF = document.createElement('div');
          var img = document.createElement('img');
          var imgs = document.createElement('div');
          var tata = this;
          my.setAttribute('class', 'fankiu-my'); //æ·»åŠ å±æ€§
          neiRong.setAttribute('class', 'fankiu-text');
          touXiang.setAttribute('class', 'fankiu-img');
          imgs.style.backgroundImage = 'url(' + '"' + this.Youimg + '"' + ')';
          imgs.style.backgroundSize = '100% 100%';
          //				img.setAttribute("class","border");
          //						span.innerText=texts;							//å¯¹åº”æ’å…¥
          if (!myIconName) {
            neiRong.appendChild(span);
            neiRong.appendChild(imgs);
          }
          imaF.appendChild(img);
          touXiang.appendChild(imaF);
          my.appendChild(touXiang);
          my.appendChild(neiRong);
          this.prent.appendChild(my);
          my.style.width = '92%'; //æ ·å¼4
          my.style.margin = '0 auto';
          my.style.lineHeight = '0.4rem';
          my.style.textAlign = 'justify';
          my.style.display = 'flex';
          my.style.padding = '0.1rem 0';
          neiRong.style.width = '86%';
          neiRong.style.position = 'relative';
          // neiRong.style.float="left";
          span.style.display = 'inline-block';
          span.style.padding = '0.16rem 0.2rem';
          span.style.background = '#fff';
          span.style.maxWidth = '77%';
          span.style.borderRadius = '0.08rem';
          span.style.fontSize = '0.32rem';
          span.style.border = '0.01rem solid #e7e6e9';
          span.style.wordWrap = 'break-word';
          span.style.float = 'left';
          touXiang.style.width = '14%';
          touXiang.style.height = '0.76rem';
          //					touXiang.style.float="left";
          imaF.style.width = '0.76rem';
          imaF.style.height = '0.76rem';
          imaF.style.border = '0.01rem solid #e7e6e9';
          imaF.style.boxSizing = 'border-box';
          imaF.style.overflow = 'hidden';
          imaF.style.borderRadius = '0.04rem';
          imaF.onclick = function () {
            //				å¯¹æ–¹ä¸ªäººèµ„æ–™
            if (yes) {
              if (DianJi) {
                console.log(DianJi);
                var imglist = JSON.parse(
                  window.localStorage.getItem('imgIdLoc')
                );
                for (var i = 0; i < imglist.length; i++) {
                  if (imglist[i].name == DianJi) {
                    window.localStorage.setItem(
                      'headPortrait_groupChat',
                      imglist[i].classIcon
                    );
                    window.localStorage.setItem('toChatName_groupChat', DianJi);
                    break;
                  }
                }
              }
              console.log(
                'å¯¹æ–¹ä¸ªäººèµ„æ–™',
                yes,
                type,
                cont,
                DianJi,
                myIconName,
                remarksNuber
              );
              window.location.href = 'ziLiaoXiangQing.html';
            }
          };
          //				img.style.width="0.38rem";
          //				img.style.height="0.38rem";
          img.style.background = '#EAEAEA';
          img.style.borderRadius = '0.04rem';
          img.style.float = 'left';
          img.src = Youimg;
          img.style.width = '100%';
          imgs.style.position = 'absolute';
          //				imgs.style.background="#fff";
          imgs.style.width = '0.16rem';
          imgs.style.height = '0.22rem';
          //				imgs.style.borderLeft="0.008rem solid #d4d2d2";
          //				imgs.style.borderTop="0.008rem solid #d4d2d2";
          //				imgs.style.transform="rotate(-45deg)";
          imgs.style.top = '0.26rem';
          imgs.style.left = '-0.13rem';
          imgs.style.Zindex = 100;
          if (type == 'yes') {
            if (DianJi) {
              console.log(DianJi);
              var imglist = JSON.parse(window.localStorage.getItem('imgIdLoc'));
              for (var i = 0; i < imglist.length; i++) {
                if (imglist[i].name == DianJi) {
                  img.src = imglist[i].classIcon;
                  break;
                }
              }
              var from_name = document.createElement('div');
              from_name.style.fontSize = '0.26rem';
              from_name.style.color = '#07111B';
              from_name.style.lineHeight = '0.2rem';
              from_name.style.padding = '0 0 0.1rem 0.1rem';
              from_name.style.color = 'rgb(180, 180, 180)';
              from_name.innerHTML = myIconName;
              neiRong.appendChild(from_name);
              neiRong.appendChild(span);
              neiRong.appendChild(imgs);
              span.innerHTML = cont; //å¯¹åº”æ’å…¥
            } else {
              span.innerHTML = cont; //å¯¹åº”æ’å…¥
            }
          } else {
            span.appendChild(this.HuanquSenqing(cont, DianJi, type));
          }
        }),
        //			æŠ•è¯‰è°ƒç”¨
        (this.BugenYuanyin = function (texts) {
          var farams = {
            //å‘é€è¯„è®ºæ¥å£
            token: this.Token,
            //					to_id:this.uid,					//å¯¹æ–¹id	æ˜¯	[string]
            terminalNo: '3',
            rid: this.uid,
            content: texts,
            ctype: 6, //ä¸¾æŠ¥åŸå› id
            //					ctype: this.selectedID		//ä¸¾æŠ¥åŸå› id
          };
          //				console.log(farams)
          Indicator.open({ spinnerType: 'fading-circle' });
          this.$http
            .post(URL.path1 + 'account/report', farams, { emulateJSON: true })
            .then(
              function (res) {
                Indicator.close();
                //					Toast("æäº¤åæˆ‘ä»¬å°†åœ¨24å°æ—¶å†…å¤„ç†")
                Toast('æŠ•è¯‰æˆåŠŸ');
                this.onlyContent = false;
                this.onlyContent1 = false;
                //					console.log(res);
              },
              function (res) {
                Indicator.close();
                Toast(data.msg);
                console.log(res);
              }
            );
        }),
        (this.HuanquSenqing = function (cont, DianJi, type) {
          //æ¢åç‰‡å’Œå‘é€é¡¹ç›®ç”³è¯·æç¤ºå¤„ç†å‡½æ•°
          var mingPian = document.createElement('div'); //æ¢åç‰‡ç”³è¯·æç¤º	  æ˜¯å¦ç¡®å®šæ¢åç‰‡  åˆ›å»ºDOMå…ƒç´     åœ¨å¯¹æ–¹å¯¹è¯æ¡†å†…æ˜¾ç¤º
          var mingText = document.createElement('p');
          var mingSpan = document.createElement('span');
          var mingFont = document.createElement('font');
          var locFromName = window.localStorage.getItem('fromName'),
            myName = window.localStorage.getItem('name');
          if (type == 'no') {
            mingSpan.innerText = 'æ˜¯';
            mingFont.innerText = 'å¦';
          } else {
            mingSpan.innerText = 'åŒæ„';
            mingFont.innerText = 'æ‹’ç»';
          }
          mingText.innerText = cont; //åå°è·å–ä¿¡æ¯æ’å…¥

          mingPian.appendChild(mingText);
          mingPian.appendChild(mingSpan);
          mingPian.appendChild(mingFont);
          // that.prent.appendChild(mingPian);						//æœ€ç»ˆè¦æ’å…¥åˆ°å¯¹è¯æ¡†å†…
          mingPian.style.width = '4.04rem';
          mingPian.style.margin = '0 auto';
          mingPian.style.minHeight = '1.26rem';
          mingPian.style.position = 'relative';
          mingPian.style.background = '#fff';
          // mingPian.style.padding="0.16rem 0.2rem";
          mingText.style.lineHeight = '0.42rem';
          mingText.style.fontSize = '0.32rem';
          mingText.style.wordWrap = 'break-word';
          mingText.style.padding = '0 0 0.72rem 0';
          mingText.style.color = '#07111B';
          mingSpan.style.position = 'absolute';
          mingSpan.style.fontSize = '0.32rem';
          mingSpan.style.display = 'inline-block';
          mingSpan.style.left = '0';
          mingSpan.style.bottom = '0';
          mingSpan.style.color = '#f5f4f9';
          mingSpan.style.width = '46%';
          mingSpan.style.height = '0.62rem';
          mingSpan.style.borderRadius = '0.08rem';
          mingSpan.style.background = '#ff7a59';
          mingSpan.style.lineHeight = '0.62rem';
          mingSpan.style.textAlign = 'center';
          var i = 0;
          if (DianJi == 1 || DianJi == 'yes') {
            i = 1;
            mingSpan.style.color = '#000000';
            mingSpan.style.background = '#f5f4f9';
          }
          mingSpan.onclick = function () {
            //æ·»åŠ å¥½å‹åŒæ„äº‹ä»¶
            var timeHour = new Date().getTime();
            var dateYes = 'no';
            if (timeHour - dateTimes > 100000) {
              // console.log(timeHour - dateTimes);
              dateYes = 'yes';
            }
            if (i == 1) {
              return;
            }
            i++;
            console.log(i);
            if (type == 'no') {
              var name = window.localStorage.getItem('name'),
                addName = window.localStorage.getItem('toChatName'),
                nickName = window.localStorage.getItem('toNames');
              //æ·»åŠ å¥½å‹ï¼›
              $.ajax({
                type: 'post',
                url: 'http://127.0.0.1:8080/post4',
                data: {
                  addName: nickName,
                  fromNumber: name,
                  addNumber: addName,
                  addFriend: 2,
                },
                success: function (data) {
                  console.log(data);
                  if (data.code == 200) {
                    mingSpan.style.color = '#000000';
                    mingSpan.style.background = '#f5f4f9';
                    //å‘å¯¹æ–¹å‘é€æ·»åŠ å¥½å‹éªŒè¯æ¶ˆæ¯
                    socket.emit('clientmessage', {
                      fromName: name,
                      toName: addName,
                      text: { friend: 'no', addName: nickName, addFriend: 2 },
                      dateTimes: dateYes,
                    });
                    alert(data.msg);
                  } else {
                    alert(data.msg);
                  }
                },
                error: function () {
                  console.log('error');
                },
              });
            } else {
              //æ·»åŠ å¥½å‹åŒæ„è¯·æ±‚
              $.ajax({
                type: 'post',
                url: 'http://127.0.0.1:8080/post5',
                data: { fromName: locFromName, myName: myName, friends: 'yes' },
                success: function (data) {
                  console.log(data);
                  if (data.code == 200) {
                    alert(data.msg);
                    $('.shuru').show();
                    mingSpan.style.color = '#000000';
                    mingSpan.style.background = '#f5f4f9';
                    //å‘å¯¹æ–¹å‘é€æ·»åŠ å¥½å‹éªŒè¯æ¶ˆæ¯
                    socket.emit('clientmessage', {
                      fromName: myName,
                      toName: locFromName,
                      text: {
                        from: myName,
                        text: 'æˆ‘é€šè¿‡äº†ä½ çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥èŠå¤©å•¦ï¼ğŸ˜„',
                        friends: 'yes',
                      },
                      dateTimes: dateYes,
                    });
                  }
                },
                error: function () {
                  console.log('error');
                },
              });
            }
          };
          mingFont.style.position = 'absolute';
          mingFont.style.fontSize = '0.32rem';
          mingFont.style.right = '0';
          mingFont.style.bottom = '0';
          mingFont.style.width = '46%';
          mingFont.style.height = '0.62rem';
          mingFont.style.borderRadius = '0.08rem';
          mingFont.style.background = '#f5f4f9';
          mingFont.style.lineHeight = '0.62rem';
          mingFont.style.textAlign = 'center';

          mingFont.onclick = function () {
            //ç»‘å®šå¥½å‹æ‹’ç»äº‹ä»¶
            if (type == 'no') {
              return;
            }
            var timeHour = new Date().getTime();
            var dateYes = 'no';
            if (timeHour - dateTimes > 100000) {
              // console.log(timeHour - dateTimes);
              dateYes = 'yes';
            }
            if (DianJi == 1) {
              return;
            }
            if (i == 1) {
              return;
            }
            i++;
            //å¥½å‹æ‹’ç»è¯·æ±‚
            $.ajax({
              type: 'post',
              url: 'http://127.0.0.1:8080/post5',
              data: { fromName: locFromName, myName: myName, friends: 'no' },
              success: function (data) {
                console.log(data);
                if (data.code == 200) {
                  // alert(data.msg);
                  mingSpan.style.color = '#000000';
                  mingSpan.style.background = '#f5f4f9';
                  //å‘å¯¹æ–¹å‘é€æ·»åŠ å¥½å‹éªŒè¯æ¶ˆæ¯
                  socket.emit('clientmessage', {
                    fromName: myName,
                    toName: locFromName,
                    text: {
                      from: myName,
                      text: 'æ‚¨æ‹’ç»äº†å¯¹æ–¹çš„å¥½å‹éªŒè¯è¯·æ±‚ï¼',
                      friends: 'no',
                    },
                    dateTimes: dateYes,
                  });
                }
              },
              error: function () {
                console.log('error');
              },
            });
          };
          return mingPian;
        }),
        (this.MingpianTishi = function (cont, name, pont) {
          //ç”³è¯·æ¢åç‰‡å¤„ç†å‡½æ•°
          var mingPianTishi = document.createElement('div'); //ç”³è¯·æ¢åç‰‡æç¤º   åˆ›å»ºDOMå…ƒç´ 
          var NameTishi = document.createElement('p');
          var SpanTishi = document.createElement('span');
          var FontTishi = document.createElement('font');
          var GerenTishi = document.createElement('p');
          SpanTishi.innerText = cont['uname']; //åå°è·å–ä¿¡æ¯æ’å…¥
          FontTishi.innerText = cont['phone']; //åå°è·å–ä¿¡æ¯æ’å…¥
          GerenTishi.innerText = 'ä¸ªäººåç‰‡';
          NameTishi.appendChild(SpanTishi);
          NameTishi.appendChild(FontTishi);
          mingPianTishi.appendChild(NameTishi);
          mingPianTishi.appendChild(GerenTishi);
          //						thata.prent.appendChild(mingPianTishi);						//æœ€ç»ˆè¦æ’å…¥åˆ°å¯¹è¯æ¡†å†…
          mingPianTishi.style.width = '2.02rem';
          mingPianTishi.style.margin = '0 auto';
          mingPianTishi.style.minHeight = '0.56rem';
          mingPianTishi.style.fontSize = '0.16rem';
          mingPianTishi.style.background = '#fff';
          NameTishi.style.lineHeight = '0.34rem';
          NameTishi.style.height = '0.4rem';
          NameTishi.style.color = '#07111B';
          SpanTishi.style.display = 'inline-block';
          SpanTishi.style.padding = '0 0.07rem 0 0';
          GerenTishi.style.borderTop = '1px solid #cfcfcf';
          GerenTishi.style.fontSize = '0.13rem';
          GerenTishi.style.padding = '0.06rem 0 0 0.03rem';
          GerenTishi.style.color = '#b4b4b4';
          mingPianTishi.onclick = function () {
            //æç¤ºæ·»åŠ é€šè®¯å½•å¼¹æ¡†
            that.$refs.tishiShow.tishiBlock(that.tongxun, FontTishi.innerText); //CanShuæ˜¯ä¸‹çº§è¦ä¼ çš„å‚æ•°
          };
          return mingPianTishi;
        });
    }
    var that = new Default();
    that.props();
  </script>
</html>
